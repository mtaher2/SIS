<!-- Admin Dashboard -->
<div class="admin-panel">
    <!-- Dashboard Header -->
    <div class="row mb-4 align-items-center">
        <div class="col-md-8">
            <h1 class="dashboard-heading">
                <i class="fas fa-tachometer-alt me-2"></i> Admin Dashboard
            </h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">Home</a></li>
                    <li class="breadcrumb-item active">Admin Dashboard</li>
                </ol>
            </nav>
        </div>
        <div class="col-md-4 text-end">
            <span class="badge rounded-pill" style="background-color: var(--primary-color);">
                Admin Access
            </span>
        </div>
    </div>

    <!-- Stats Overview -->
    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="card stats-card h-100">
                <div class="card-body text-center">
                    <i class="fas fa-users stats-icon"></i>
                    <h2><%= stats.totalUsers %></h2>
                    <p class="text-muted mb-0">Total Users</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card stats-card h-100">
                <div class="card-body text-center">
                    <i class="fas fa-chalkboard-teacher stats-icon"></i>
                    <h2><%= stats.instructors %></h2>
                    <p class="text-muted mb-0">Instructors</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card stats-card h-100">
                <div class="card-body text-center">
                    <i class="fas fa-user-graduate stats-icon"></i>
                    <h2><%= stats.students %></h2>
                    <p class="text-muted mb-0">Students</p>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card stats-card h-100">
                <div class="card-body text-center">
                    <i class="fas fa-book stats-icon"></i>
                    <h2><%= stats.courses %></h2>
                    <p class="text-muted mb-0">Active Courses</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Account Management Section -->
    <div class="account-management-section">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="fas fa-user-cog me-2"></i> Account Management</h5>
                <div>
                    <a href="/admin/users/create" class="btn btn-success btn-sm">
                        <i class="fas fa-plus me-1"></i> Create New User
                    </a>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if(recentUsers && recentUsers.length > 0) { %>
                                <% recentUsers.forEach(user => { %>
                                    <tr>
                                        <td><%= user.first_name %> <%= user.last_name %></td>
                                        <td><%= user.username %></td>
                                        <td><%= user.email %></td>
                                        <td>
                                            <% if(user.role === 'admin') { %>
                                                <span class="badge rounded-pill" style="background-color: var(--primary-color);">Admin</span>
                                            <% } else if(user.role === 'instructor') { %>
                                                <span class="badge rounded-pill" style="background-color: #ff9800;">Instructor</span>
                                            <% } else { %>
                                                <span class="badge rounded-pill" style="background-color: var(--secondary-color);">Student</span>
                                            <% } %>
                                        </td>
                                        <td>
                                            <% if(user.is_active) { %>
                                                <span class="badge bg-success">Active</span>
                                            <% } else { %>
                                                <span class="badge bg-danger">Inactive</span>
                                            <% } %>
                                        </td>
                                        <td>
                                            <div class="btn-group">
                                                <a href="/admin/users/edit/<%= user.user_id %>" class="btn btn-sm btn-primary">
                                                    <i class="fas fa-edit"></i>
                                                </a>
                                                <button type="button" class="btn btn-sm btn-danger" 
                                                        onclick="confirmDelete('/admin/users/delete/<%= user.user_id %>', 'user')">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                                <a href="/admin/users/reset-password/<%= user.user_id %>" class="btn btn-sm btn-warning">
                                                    <i class="fas fa-key"></i>
                                                </a>
                                            </div>
                                        </td>
                                    </tr>
                                <% }) %>
                            <% } else { %>
                                <tr>
                                    <td colspan="6" class="text-center">No users found</td>
                                </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
                <div class="text-end mt-3">
                    <a href="/admin/users" class="btn btn-primary">View All Users</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Course Management Section -->
    <div class="course-management-section mt-4">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="fas fa-book-open me-2"></i> Course Management</h5>
                <div>
                    <a href="/admin/courses/create" class="btn btn-success btn-sm">
                        <i class="fas fa-plus me-1"></i> Create New Course
                    </a>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead>
                            <tr>
                                <th>Course Code</th>
                                <th>Title</th>
                                <th>Credits</th>
                                <th>Semester</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if(recentCourses && recentCourses.length > 0) { %>
                                <% recentCourses.forEach(course => { %>
                                    <tr>
                                        <td><%= course.course_code %></td>
                                        <td><%= course.title %></td>
                                        <td><%= course.credit_hours %></td>
                                        <td><%= course.semester_name %></td>
                                        <td>
                                            <% if(course.is_active) { %>
                                                <span class="badge bg-success">Active</span>
                                            <% } else { %>
                                                <span class="badge bg-danger">Inactive</span>
                                            <% } %>
                                        </td>
                                        <td>
                                            <div class="btn-group">
                                                <a href="/admin/courses/edit/<%= course.course_id %>" class="btn btn-sm btn-primary">
                                                    <i class="fas fa-edit"></i>
                                                </a>
                                                <button type="button" class="btn btn-sm btn-danger" 
                                                        onclick="confirmDelete('/admin/courses/delete/<%= course.course_id %>', 'course')">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                <% }) %>
                            <% } else { %>
                                <tr>
                                    <td colspan="6" class="text-center">No courses found</td>
                                </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
                <div class="text-end mt-3">
                    <a href="/admin/courses" class="btn btn-primary">View All Courses</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Announcement Section -->
    <div class="announcement-section mt-4">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="fas fa-bullhorn me-2"></i> Announcements</h5>
                <div>
                    <a href="/admin/announcements/create" class="btn btn-success btn-sm">
                        <i class="fas fa-plus me-1"></i> Create Announcement
                    </a>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Date</th>
                                <th>Target</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if(recentAnnouncements && recentAnnouncements.length > 0) { %>
                                <% recentAnnouncements.forEach(announcement => { %>
                                    <tr>
                                        <td><%= announcement.title %></td>
                                        <td><%= new Date(announcement.created_at).toLocaleDateString() %></td>
                                        <td>
                                            <% if(announcement.target_type === 'all') { %>
                                                <span class="badge badge-target-all">All Users</span>
                                            <% } else if(announcement.target_type === 'instructors') { %>
                                                <span class="badge badge-target-instructors">Instructors</span>
                                            <% } else if(announcement.target_type === 'students') { %>
                                                <span class="badge badge-target-students">Students</span>
                                            <% } else { %>
                                                <span class="badge badge-target-course">Course: <%= announcement.course_code || 'Unknown' %></span>
                                            <% } %>
                                        </td>
                                        <td>
                                            <div class="btn-group">
                                                <a href="/admin/announcements/edit/<%= announcement.announcement_id %>" class="btn btn-sm btn-primary">
                                                    <i class="fas fa-edit"></i>
                                                </a>
                                                <button type="button" class="btn btn-sm btn-danger" 
                                                        onclick="confirmDelete('/admin/announcements/delete/<%= announcement.announcement_id %>', 'announcement')">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                <% }) %>
                            <% } else { %>
                                <tr>
                                    <td colspan="4" class="text-center">No announcements found</td>
                                </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
                <div class="text-end mt-3">
                    <a href="/admin/announcements" class="btn btn-primary">View All Announcements</a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this <span id="deleteItemType"></span>? This action cannot be undone.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <form id="deleteForm" method="POST">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    function confirmDelete(url, itemType) {
        document.getElementById('deleteForm').action = url;
        document.getElementById('deleteItemType').textContent = itemType;
        new bootstrap.Modal(document.getElementById('deleteModal')).show();
    }
</script> 